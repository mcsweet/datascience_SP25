ggplot(aes(x  = Type_of_Animal, y = Age_First_Friend)) +
geom_boxplot(aes(fill = Type_of_Animal), width = 0.5) +
geom_jitter()
#Housenumber vs pet
df_islands %>%
filter(Consent == "yes") %>%
ggplot(aes(x  = House_Number, y = Type_of_Animal, color = Type_of_Animal)) +
geom_jitter()
library(tidyverse)
library(rsample)
## NOTE: No need to edit; this visual helps explain the pi estimation scheme
tibble(x = seq(0, 1, length.out = 100)) %>%
mutate(y = sqrt(1 - x^2)) %>%
ggplot(aes(x, y)) +
annotate(
"rect",
xmin = 0, ymin = 0, xmax = 1, ymax = 1,
fill = "grey40",
size = 1
) +
geom_ribbon(aes(ymin = 0, ymax = y), fill = "coral") +
geom_line() +
annotate(
"label",
x = 0.5, y = 0.5, label = "Sc",
size = 8
) +
annotate(
"label",
x = 0.8, y = 0.8, label = "St",
size = 8
) +
scale_x_continuous(breaks = c(0, 1/2, 1)) +
scale_y_continuous(breaks = c(0, 1/2, 1)) +
theme_minimal() +
coord_fixed()
## TASK: Choose a sample size and generate samples
n <- 40000 # Choose a sample size
x <- runif(n, min = 0, max = 1)
y <- runif(n, min = 0, max = 1)
df_q1 <-
tibble(x,y)
df_q1
## NOTE: Do not edit this code
# Correct sample size
assertthat::assert_that(
dim(df_q1) %>%
.[[1]] == n,
msg = "The sample size should be `n`"
)
# Correct column names
assertthat::assert_that(
setequal(names(df_q1), c("x", "y")),
msg = "df_q1 must include the columns `x` and `y`"
)
print("Good")
## TASK: Finish implementing this function
stat <- function(x, y) {
r <- sqrt(x^2 + y^2)
in_circle <- r <= 1
stat <- 4 * in_circle
}
## TASK: Finish writing these assert statements
# Check the value for points *inside* the circle
assertthat::assert_that(
tibble(x = 0.1, y = 0.1) %>% # Pick a point *inside* the circle
mutate(stat = stat(x, y)) %>%
pull(stat) %>%
.[[1]] == 4,
# ???, # Write the correct value of stat() here
msg = "Incorrect value when a point is inside the circle"
)
# Check the value for points *outside* the circle
assertthat::assert_that(
tibble(x = 0.9, y = 0.9) %>% # Pick a point *outside* the circle
mutate(stat = stat(x, y)) %>%
pull(stat) %>%
.[[1]] == 0,
# ???, # Write the correct value of stat() here
msg = "Incorrect value when a point is outside the circle"
)
print("Your assertions passed, but make sure they're checking the right thing!")
## TASK: Estimate pi using your data from q1
df_q3 <-
df_q1 %>%
# mutate(sum_sq = x^2 + y^2) %>%
# filter(sum_sq <= 1)%>%
#summarise(pi_est = 4 * length(sum_sq)/n)
mutate(stat = stat(x,y)) %>%
summarize(pi_est = mean(stat))
df_q3
## NOTE: Do not edit this code
# Correct sample size
assertthat::assert_that(
dim(df_q3) %>%
.[[1]] == 1,
msg = "This result should have just one row"
)
# Correct column names
assertthat::assert_that(
setequal(names(df_q3), c("pi_est")),
msg = "df_q3 must include the column `pi_est`"
)
print("Good")
## TASK: Finish the code below
df_q4 <-
df_q1 %>%
bootstraps(., times = 1000) %>%
mutate(
pi_est = map_dbl(
splits,
function(split_df) {
analysis(split_df) %>%
# Estimate pi (pi_est) using the resampled data;
# this should be *identical* to the
# code you wrote for q3
mutate(stat = stat(x,y)) %>%
summarize(pi_est = mean(stat)) %>%
pull(pi_est)
}
)
)
## NOTE: Do not edit; use this to visualize your results
df_q4 %>%
ggplot(aes(pi_est)) +
geom_histogram()
## TASK: Compute a bootstrap confidence interval at the 95% level (alpha = 0.05)
z_c <- qnorm( 1 - (1 - 0.95) / 2 )
df_q5 <-
df_q4 %>%
summarize(
mean = mean(pi_est),
sd = sd(pi_est),
se = sd(pi_est)/sqrt(length(pi_est)),
pi_lo = mean(pi_est) - z_c * sd(pi_est) / sqrt(length(pi_est)),
pi_hi = mean(pi_est) + z_c * sd(pi_est) / sqrt(length(pi_est))
)
df_q5
df_q1 %>%
mutate(stat = stat(x,y)) %>%
summarize(
mean_pi = mean(stat),
sd_pi = sd(stat),
z_c = qnorm( 1 - (1 - 0.95) / 2 ),
se_pi = sd_pi/sqrt(length(stat)),
pi_lo = mean_pi - z_c * sd_pi / sqrt(length(stat)),
pi_hi = mean_pi + z_c * sd_pi / sqrt(length(stat))
)
## TASK: Compute a bootstrap confidence interval at the 95% level (alpha = 0.05)
alpha <- 0.05
df_q5 <-
df_q4 %>%
summarize(
mean_lo = quantile(sample_mean, alpha / 2),
mean_up = quantile(sample_mean, 1 - alpha / 2)
)
## TASK: Compute a bootstrap confidence interval at the 95% level (alpha = 0.05)
alpha <- 0.05
df_q5 <-
df_q4 %>%
summarize(
mean_lo = quantile(mean(pi_est), alpha / 2),
mean_up = quantile(mean(pi_est), 1 - alpha / 2)
)
df_q5
## TASK: Compute a bootstrap confidence interval at the 95% level (alpha = 0.05)
alpha <- 0.05
df_q5 <-
df_q4 %>%
summarize(
mean_lo = quantile(pi_est, alpha / 2),
mean_up = quantile(pi_est, 1 - alpha / 2)
)
df_q5
library(tidyverse)
library(rsample)
# TODO: Include any other packages you need
filename_islands <- "./data/Data_C10.csv"
df_islands <-
read_csv(
filename_islands
)
#
# df_islands %>%
#   filter(Consent == "yes") %>%
#   arrange(desc(Age_First_Friend)) %>%
#   ggplot(aes(x  = Age_First_Friend, fill = Have_pet)) +
#   geom_bar(position = "dodge")
#
# df_islands %>%
#   filter(Consent == "yes") %>%
#   arrange(desc(Age)) %>%
#   ggplot(aes(x  = Age, y = Age_First_Friend, color = Have_pet)) +
#   geom_jitter()
#
# df_islands %>%
#   filter(Consent == "yes") %>%
#   arrange(desc(Age)) %>%
#   ggplot(aes(x  = Age_First_Friend, y = Household_Size, color = Have_pet)) +
#   geom_jitter()
#
# df_islands %>%
#   filter(Consent == "yes") %>%
#   arrange(desc(Age)) %>%
#   ggplot(aes(x  = Age_First_Friend, y = Household_Size, color = Moved_Later)) +
#   geom_jitter()
#
# df_islands %>%
#    filter(Consent == "yes") %>%
#    filter(Have_pet == "pet") %>%
#    filter(Moved_Later == "no") %>%
#    ggplot(aes(x  = Type_of_Animal, y = Age)) +
#    geom_boxplot()
#
# df_islands %>%
#   filter(Consent == "yes") %>%
#   ggplot(aes(x = Age)) +
#   geom_histogram(bins = 20)
#age of first friend
df_islands %>%
filter(Consent == "yes") %>%
ggplot(aes(x = Age_First_Friend)) +
geom_density()
#household size
df_islands %>%
filter(Consent == "yes") %>%
ggplot(aes(x = Household_Size)) +
geom_bar()
#age of first friend
df_islands %>%
filter(Consent == "yes") %>%
filter(Moved_Later == "no") %>%
ggplot(aes(x = Household_Size, y = Age_First_Friend)) +
geom_jitter() +
geom_smooth()
#AGE FIRST FIREND, MOVED LATER, HOUSEHOLD SIZE
df_islands %>%
filter(Consent == "yes") %>%
arrange(desc(Age)) %>%
ggplot(aes(x  = Age_First_Friend, y = Household_Size, color = Moved_Later)) +
geom_jitter()
#HAVE PET AND AGE OF FIRST FRIEND
df_islands %>%
filter(Consent == "yes") %>%
filter(Moved_Later == "no") %>%
ggplot(aes(x  = Have_pet, y = Age_First_Friend)) +
geom_boxplot(aes(fill = Have_pet), width = 0.5) +
geom_jitter()
df_islands %>%
filter(Consent == "yes") %>%
filter(Moved_Later == "no") %>%
filter(Have_pet == "pet") %>%
ggplot(aes(x  = Type_of_Animal, y = Age_First_Friend)) +
geom_boxplot(aes(fill = Type_of_Animal), width = 0.5) +
geom_jitter(height = 0)
#Housenumber vs pet
df_islands %>%
filter(Consent == "yes") %>%
ggplot(aes(x  = House_Number, y = Type_of_Animal, color = Type_of_Animal)) +
geom_jitter()
library(tidyverse)
## TODO: Give the filename for your copy of Table B01003
filename_pop <- "./data/Pop_Data.csv"
## NOTE: No need to edit
df_pop <-
read_csv(
filename_pop,
skip = 1,
) %>%
rename(
population_estimate = `Estimate!!Total`
)
df_pop
## TODO: Give the filename for your copy of Table S1903
filename_income <- "./data/income.csv"
## NOTE: No need to edit
df_income <-
read_csv(filename_income, skip = 1)
df_income
## NOTE: No need to edit, use to check you got the right file.
assertthat::assert_that(
df_income %>%
filter(Geography == "0500000US01001") %>%
pull(`Estimate!!Percent Distribution!!FAMILY INCOME BY FAMILY SIZE!!2-person families`)
== 45.6
)
print("Well done!")
df_q3 <-
df_income %>%
select(
Geography,
contains("Geographic"),
# This will select only the numeric d-person family columns;
# it will ignore the annotation columns
contains("median") & matches("\\d-person families") & !contains("Annotation of")
) %>%
mutate(across(contains("median"), as.numeric)) %>%
## TODO: Pivot the data, rename the columns
pivot_longer(
names_pattern = "(Estimate|Margin of Error).*(\\d-person families).*",
names_to = c(".value", "category"),
cols = matches("(Estimate|Margin of Error)")
) %>%
rename("income_estimate" = "Estimate",
"income_moe" = "Margin of Error",
"geographic_area_name" = "Geographic Area Name"
) %>%
glimpse()
## NOTE: No need to edit
assertthat::assert_that(setequal(
names(df_q3),
c("Geography", "geographic_area_name", "category", "income_estimate", "income_moe")
))
assertthat::assert_that(
df_q3 %>%
filter(Geography == "0500000US01001", category == "2-person families") %>%
pull(income_moe)
== 6663
)
print("Nice!")
df_q4 <-
df_q3 %>%
mutate(income_SE = income_moe / 1.645,
income_CV = income_SE / income_estimate,
income_lo = income_estimate - 2.576 * income_SE,
income_hi = income_estimate + 2.576 * income_SE)
df_q4
## NOTE: No need to edit
assertthat::assert_that(setequal(
names(df_q4),
c("Geography", "geographic_area_name", "category", "income_estimate", "income_moe",
"income_SE", "income_lo", "income_hi", "income_CV")
))
assertthat::assert_that(
abs(
df_q4 %>%
filter(Geography == "0500000US01001", category == "2-person families") %>%
pull(income_SE) - 4050.456
) / 4050.456 < 1e-3
)
assertthat::assert_that(
abs(
df_q4 %>%
filter(Geography == "0500000US01001", category == "2-person families") %>%
pull(income_lo) - 54513.72
) / 54513.72 < 1e-3
)
assertthat::assert_that(
abs(
df_q4 %>%
filter(Geography == "0500000US01001", category == "2-person families") %>%
pull(income_hi) - 75380.28
) / 75380.28 < 1e-3
)
assertthat::assert_that(
abs(
df_q4 %>%
filter(Geography == "0500000US01001", category == "2-person families") %>%
pull(income_CV) - 0.06236556
) / 0.06236556 < 1e-3
)
print("Nice!")
## TODO: Join df_q4 and df_pop by the appropriate column
df_data <-
left_join(df_pop, df_q4, b = "Geography")
## NOTE: No need to edit; run and inspect
wid <- 0.5
df_data %>%
filter(str_detect(geographic_area_name, "Massachusetts")) %>%
mutate(
county = str_remove(geographic_area_name, " County,.*$"),
county = fct_reorder(county, income_estimate)
) %>%
ggplot(aes(county, income_estimate, color = category)) +
geom_errorbar(
aes(ymin = income_lo, ymax = income_hi),
position = position_dodge(width = wid)
) +
geom_point(position = position_dodge(width = wid)) +
coord_flip() +
labs(
x = "County",
y = "Median Household Income"
)
df_data %>%
ggplot(aes(x = population_estimate, y = income_SE, color = category, group = 1)) +
geom_point(alpha = 0.1) +
theme_minimal() +
scale_y_log10() +
scale_x_log10() +
geom_smooth()
## TODO: Pose and answer your own question about the data
filename_income_elevation <- "./data/dataset_income_elevation_america.csv"
## NOTE: No need to edit
df_income_elevation <-
read_csv(filename_income_elevation)
graph_e_i <-
df_income_elevation %>%
mutate(income_SE = normalized_income_moe / 1.645,
income_CV = income_SE / normalized_income_estimate,
income_lo = normalized_income_estimate - 2.576 * income_SE,
income_hi = normalized_income_estimate + 2.576 * income_SE,
elevation_SE = STD/sqrt(COUNT),
elevation_CV = elevation_SE/MEAN,
elevation_lo = MEAN - 2.576 * elevation_SE,
elevation_hi = MEAN + 2.576 * elevation_SE,
elevation = MEAN
)
graph_e_i %>%
#filter(STATE_NAME == "Washington"|STATE_NAME == "California" |STATE_NAME == "Oregon") %>%
ggplot(aes(x = elevation, y = normalized_income_estimate)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
#filter(STATE_NAME == "Washington"|STATE_NAME == "California" |STATE_NAME == "Oregon") %>%
group_by(STATE_NAME) %>%
ggplot(aes(x = elevation, y = income_SE)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
filter(STATE_NAME == "California") %>%
ggplot(aes(x = elevation, y = normalized_income_estimate, color = STATE_NAME, group = 1)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
filter(STATE_NAME == "California") %>%
ggplot(aes(x = elevation, y = income_SE, color = STATE_NAME, group = 1)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
## TODO: Join df_q4 and df_pop by the appropriate column
df_data <-
left_join(df_q4, df_pop, b = "Geography")
## NOTE: No need to edit; run and inspect
wid <- 0.5
df_data %>%
filter(str_detect(geographic_area_name, "Massachusetts")) %>%
mutate(
county = str_remove(geographic_area_name, " County,.*$"),
county = fct_reorder(county, income_estimate)
) %>%
ggplot(aes(county, income_estimate, color = category)) +
geom_errorbar(
aes(ymin = income_lo, ymax = income_hi),
position = position_dodge(width = wid)
) +
geom_point(position = position_dodge(width = wid)) +
coord_flip() +
labs(
x = "County",
y = "Median Household Income"
)
df_data %>%
ggplot(aes(x = population_estimate, y = income_SE, color = category, group = 1)) +
geom_point(alpha = 0.1) +
theme_minimal() +
scale_y_log10() +
scale_x_log10() +
geom_smooth()
## TODO: Pose and answer your own question about the data
filename_income_elevation <- "./data/dataset_income_elevation_america.csv"
## NOTE: No need to edit
df_income_elevation <-
read_csv(filename_income_elevation)
graph_e_i <-
df_income_elevation %>%
mutate(income_SE = normalized_income_moe / 1.645,
income_CV = income_SE / normalized_income_estimate,
income_lo = normalized_income_estimate - 2.576 * income_SE,
income_hi = normalized_income_estimate + 2.576 * income_SE,
elevation_SE = STD/sqrt(COUNT),
elevation_CV = elevation_SE/MEAN,
elevation_lo = MEAN - 2.576 * elevation_SE,
elevation_hi = MEAN + 2.576 * elevation_SE,
elevation = MEAN
)
graph_e_i %>%
#filter(STATE_NAME == "Washington"|STATE_NAME == "California" |STATE_NAME == "Oregon") %>%
ggplot(aes(x = elevation, y = normalized_income_estimate)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
#filter(STATE_NAME == "Washington"|STATE_NAME == "California" |STATE_NAME == "Oregon") %>%
group_by(STATE_NAME) %>%
ggplot(aes(x = elevation, y = income_SE)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
filter(STATE_NAME == "California") %>%
ggplot(aes(x = elevation, y = normalized_income_estimate, color = STATE_NAME, group = 1)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
graph_e_i %>%
filter(STATE_NAME == "California") %>%
ggplot(aes(x = elevation, y = income_SE, color = STATE_NAME, group = 1)) +
geom_point(alpha = 1) +
scale_y_log10() +
#scale_x_log10() +
geom_smooth()
